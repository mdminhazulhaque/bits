<!DOCTYPE html>
<html lang="en-us">
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="theme-color" content="#000000">
  <meta name="msapplication-navbutton-color" content="#000000">
  <meta name="apple-mobile-web-app-status-bar-style" content="#000000">
  <meta name="description" content="Several days ago I got my home router burnt due to the frequent thunderstorms. Luckily, only the WAN port of the router was damaged. So I decided to use ...">
  <meta name="author" content="Md. Minhazul Haque">
  <script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Bits",
      "item": "https://bits.mdminhazulhaque.io/"
    },{
      "@type": "ListItem",
      "position": 2,
      "name": "ddwrt",
      "item": "https://bits.mdminhazulhaque.io/ddwrt"
    },{
      "@type": "ListItem",
      "position": 3,
      "name": "Successful Installation of DD-WRT for TL-WR845N",
      "item": "https://bits.mdminhazulhaque.io//ddwrt/successful-installation-of-dd-wrt-for-tl-wr845n.html"
    }]
  }</script>
  <title>Successful Installation of DD-WRT for TL-WR845N | Bits</title>
  <link href="https://fonts.googleapis.com/css?family=Quicksand:400,700|Inconsolata" rel="stylesheet">
  <link href="https://mdminhazulhaque.github.io/solaimanlipi/css/solaimanlipi.css" rel="stylesheet" type="text/css">
  <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="/public/css/print.css">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon.png">
  <link rel="icon" type="image/x-icon" href="/public/favicon.ico?v=20190609">
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  <style>.blink{animation:blink 1s infinite}@keyframes blink{to{opacity:.0}}</style>
</head>

  <body>
    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
        Bits<span class="blink">_</span>
        </a>
      </h1>
      <p class="lead">Random posts written by <a href="https://mdminhazulhaque.io">Md. Minhazul Haque</a></p>
      <p>Find me at ...
      <br><a href="https://github.com/mdminhazulhaque"><i class="fa fa-fw fa-github"></i> Github</a>
      <br><a href="https://stackexchange.com/users/1348058/md-minhazul-haque?tab=accounts"><i class="fa fa-fw fa-stack-exchange"></i> StackExchange</a>
      <br><a href="https://bd.linkedin.com/in/mdminhazulhaque"><i class="fa fa-fw fa-linkedin"></i> LinkedIn</a>
      <br><a href="https://twitter.com/mdminhazulhaque"><i class="fa fa-fw fa-twitter"></i> Twitter</a>
      <br><a href="https://www.instagram.com/md.minhazul.haque/"><i class="fa fa-fw fa-instagram"></i> Instagram</a>
      </p>
    </div>
    <p>&copy; 2012 - 2019. All rights reserved.</p>
  </div>
</div>

    <div class="content container">
      <div class="post">
  <h1 class="post-title">Successful Installation of DD-WRT for TL-WR845N</h1>
  <hr>
  <i class="fa fa-fw fa-calendar"></i>16 May 2018 <i class="fa fa-fw fa-tag"></i><a href="/ddwrt">ddwrt</a>
  <hr>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <ins class="adsbygoogle"
       style="display:inline-block;width:728px;height:90px"
       data-ad-client="ca-pub-9642838276352812"
       data-ad-slot="2958174403"></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  <p>Several days ago I got my home router burnt due to the frequent thunderstorms. Luckily, only the WAN port of the router was damaged. So I decided to use the switch interface as WAN. I knew how to configure the switch as WAN on OpenWRT. Unfortunately there was no modded firmware for this model. I searched over the internet and tried flashing some firmwares. But none of them worked. Moreover, latest models from TP-Link does not support flashing 3rd party firmware from the WebUI.</p>

<p>So I opened the case of the router, took out the PCB, and insert 4 male headers on the debug UART port. This is how the UART pin mapping looks like -</p>

<p><img src="https://i.imgur.com/FH7i7oT.jpg" alt="PCB" /></p>

<p><img src="https://i.imgur.com/aoN5zIT.jpg" alt="Debug UART" /></p>

<p>From the debug log, I found that the chip model is Qualcomm Atheros QCA9533-BL3A and it was connected to 32MB DRAM and 4 MB SPI Flash. I searched in the DD-WRT forum and found that the model is a rebranded version of TP Link TL-WR841ND v10. So I decided to use a firmware which was built for TL-WR841ND. I failed again because the product information in the firmware header was mismatched. But, I am glad that a user named <code class="highlighter-rouge">ian5142c</code> from <a href="https://www.dd-wrt.com/phpBB2/viewtopic.php?p=1107635">DD-WRT forum</a> uploaded a firmware with the correct header info for that model.</p>

<p>I had to install TFTP server in my Linux PC and ran it via <code class="highlighter-rouge">xinetd</code>. Here is the config file located at <code class="highlighter-rouge">/etc/xinetd.d/tftp</code> -</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>service tftp
<span class="o">{</span>
protocol        <span class="o">=</span> udp
port            <span class="o">=</span> 69
socket_type     <span class="o">=</span> dgram
<span class="nb">wait</span>            <span class="o">=</span> <span class="nb">yes
</span>user            <span class="o">=</span> nobody
server          <span class="o">=</span> /usr/sbin/in.tftpd
server_args     <span class="o">=</span> /tmp
disable         <span class="o">=</span> no
<span class="o">}</span>
</code></pre></div></div>

<p>I downloaded the correct firmware from <a href="https://www.dd-wrt.com/phpBB2/download.php?id=40123&amp;sid=8dea5fdab81f6bfcf0ad214be2334488">this link</a> and renamed it as <code class="highlighter-rouge">wr845nv1_tp_recovery.bin</code> and put it in <code class="highlighter-rouge">/tmp</code>. Then I connected the router with my computer via ethernet cable. As I said the router’s WAN port was damaged, so I used one of the four LAN ports. Then I set my computer’s IP to <code class="highlighter-rouge">192.168.1.86</code> so that the router can find this IP while booting in recovery mode. In that case, the RESET button needs to be pressed and hold while powering on the router.</p>

<p>I could see the debug messages coming through the UART console. Then uboot pulled the firmware from my computer, flashed it and rebooted by itself. After a minute, I got a broadcasting SSID named <code class="highlighter-rouge">ddwrt</code> with open encryption in my phone’s WiFI menu. After getting connected through the WiFi, I browsed the link <code class="highlighter-rouge">http://192.168.1.1</code> (use <code class="highlighter-rouge">admin</code> as both the username and password) and found that control panel impressive.</p>

<p>Rest of the configuration process were quite simple. Then at first, I disabled the DHCP Server from <code class="highlighter-rouge">eth0</code> (switch) and changed the WAN from <code class="highlighter-rouge">eth1</code> to <code class="highlighter-rouge">eth0</code>. Finally, I got the link up using PPPoE.</p>

<p>After completing all these terms, I am satisfied and my <code class="highlighter-rouge">hacked</code> router is performing quite good.</p>

<blockquote>
  <p>You can use this beta firmwares from dd-wrt also (<strong>at your own risk</strong>)</p>

  <ul>
    <li><a href="ftp://ftp.dd-wrt.com/betas/2019/02-19-2019-r38840/tplink_tl-wr841ndv10/">wr841ndv10</a></li>
    <li><a href="ftp://ftp.dd-wrt.com/betas/2019/02-19-2019-r38840/tplink_tl-wr841ndv11/">wr841ndv11</a></li>
  </ul>
</blockquote>

  <ins class="adsbygoogle"
       style="display:inline-block;width:728px;height:90px"
       data-ad-client="ca-pub-9642838276352812"
       data-ad-slot="7351100586"></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'https://bitsfromminhaz.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</div>


    </div>
  </body>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-57632461-7', 'auto');
  ga('send', 'pageview');
</script>
</html>
